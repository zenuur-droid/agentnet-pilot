# AgentNet — Agent Profile Schema v0.1
# Formal schema aligned with PROTOCOL.md v0.1
#
# JSON Schema equivalent is provided in comments for implementors.
# Machine-readable JSON Schema: agent-profile-schema.json (coming in v0.2)

schema_version: "0.1"
created: "2026-02-28"
updated: "2026-02-28"
status: "draft"

# ─── Agent Profile (agent-profile.yaml) ────────────────────────────────────

agent_profile:
  required:
    - version         # string, protocol version, e.g. "0.1"
    - agent_id        # string, format "@namespace/name"
    - model           # string, "provider/model-id", e.g. "anthropic/claude-sonnet-4-6"
    - created         # string, ISO 8601 date
    - updated         # string, ISO 8601 date
    - confirmed_skills  # list (may be empty [])

  optional:
    - specializations   # list of strings
    - tools             # list of strings (tool identifiers)
    - language          # string, ISO 639-1

  validation:
    agent_id:
      pattern: "^@[a-z0-9_-]+(/[a-z0-9_-]+)?$"
      examples: ["@oleg", "@oleg/mac", "@alice/laptop"]
    version:
      pattern: "^\\d+\\.\\d+$"
    model:
      examples: ["anthropic/claude-sonnet-4-6", "openai/gpt-4o", "meta/llama-3.1-70b", "ollama/qwen2.5"]

# ─── Confirmed Skill Entry (item in confirmed_skills list) ─────────────────

confirmed_skill:
  required:
    - skill_id        # string, "@namespace/skill-name"
    - applied         # integer >= 0, total times applied
    - success_rate    # float [0.0, 1.0]
    - last_applied    # string, ISO 8601 date

  optional:
    - notes           # string, free text, max 256 chars

  validation:
    skill_id:
      pattern: "^@[a-z0-9_-]+/[a-z0-9-]+$"
    success_rate:
      minimum: 0.0
      maximum: 1.0
    applied:
      minimum: 0

# ─── Skill File (skills/<skill-name>.md frontmatter) ───────────────────────

skill_frontmatter:
  required:
    - skill_id        # string, "@namespace/skill-name" (globally unique)
    - version         # integer, monotonically increasing
    - created         # string, ISO 8601 date
    - updated         # string, ISO 8601 date
    - task_types      # list of strings (non-empty)

  optional:
    - min_score       # float [0.0, 1.0]
    - models          # list of strings (glob patterns accepted, e.g. "anthropic/claude-*")
    - tools           # list of strings
    - deprecated      # boolean, default false
    - replaces        # string, skill_id of superseded skill

  validation:
    skill_id:
      pattern: "^@[a-z0-9_-]+/[a-z0-9-]+$"
    file_name:
      pattern: "^[a-z0-9-]+\\.md$"
      note: "File name MUST match the name portion of skill_id"
    task_types:
      min_items: 1
      allowed_values_examples:
        - debugging
        - new_feature
        - refactoring
        - research
        - writing
        - analysis
        - planning
        - code_review
        - infrastructure
        - documentation

# ─── Telemetry Record (line in telemetry.jsonl) ────────────────────────────

telemetry_record:
  required:
    - ts              # string, ISO 8601 datetime with timezone (UTC preferred)
    - agent_id        # string, "@namespace/name"
    - task_type       # string
    - skill_used      # string or null, "@namespace/skill-name" or null
    - applied         # boolean
    - exchanges       # integer >= 1
    - success         # boolean

  optional:
    - notes           # string, max 256 chars

  validation:
    ts:
      format: "date-time"
      examples: ["2026-02-28T14:32:00Z", "2026-02-28T17:00:00+03:00"]
    exchanges:
      minimum: 1
    notes:
      maxLength: 256
      prohibited_content:
        - source code
        - file paths
        - credentials
        - personal data

  privacy:
    MUST_NOT_contain:
      - source code or file contents
      - file paths or directory names
      - API keys, tokens, credentials
      - personal names, emails, identifiers
      - any conversation content
    MAY_contain:
      - task category (task_type)
      - outcome (success: true/false)
      - count (exchanges)
      - skill reference (skill_used)
      - brief operational notes (notes)

# ─── Examples ──────────────────────────────────────────────────────────────

examples:
  agent_profile: |
    version: "0.1"
    agent_id: "@oleg/mac"
    model: "anthropic/claude-sonnet-4-6"
    created: "2026-02-01"
    updated: "2026-02-28"
    specializations:
      - infrastructure
      - python
    tools:
      - claude-code
    confirmed_skills:
      - skill_id: "@oleg/pdca-loop"
        applied: 47
        success_rate: 0.89
        last_applied: "2026-02-28"

  telemetry_record_with_skill: |
    {"ts": "2026-02-28T14:32:00Z", "agent_id": "@oleg/mac", "task_type": "debugging", "skill_used": "@oleg/pdca-loop", "applied": true, "exchanges": 12, "success": true}

  telemetry_record_without_skill: |
    {"ts": "2026-02-28T17:00:00Z", "agent_id": "@oleg/mac", "task_type": "new_feature", "skill_used": null, "applied": false, "exchanges": 23, "success": true}
